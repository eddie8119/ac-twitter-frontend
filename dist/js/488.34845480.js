(self["webpackChunkforum_front_end_vue"]=self["webpackChunkforum_front_end_vue"]||[]).push([[488],{98913:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});s(68309);var r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"navpillHeader-container"}},[e._m(0),t("div",{staticClass:"navpill-info-container flex-column"},[t("router-link",{staticClass:"navpillHeader-title",attrs:{to:"/user"}},[e._v(" "+e._s(e.currentUser.name)+" ")]),t("p",{staticClass:"post-number-hint"},[e._v(" "+e._s(e.currentUser.tweetsCount)+" "),t("span",[e._v("推文")])])],1)])},n=[function(){var e=this,t=e._self._c;return t("a",{attrs:{href:"javascript:history.back()"}},[t("img",{staticClass:"arrow-icon",attrs:{src:s(57139),alt:"回到上一頁"}})])}],i=s(4648),a=s(63822);const o={name:"NavpillHeader",data:function(){return{isLoading:!0}},computed:(0,i.Z)({},(0,a.rn)(["currentUser"]))},l=o;var c=s(1001),u=(0,c.Z)(l,r,n,!1,null,null,null);const d=u.exports},14951:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex",attrs:{id:"navpillUser-container"}},[t("div",{staticClass:"navpill-title-container"},[t("router-link",{staticClass:"navpill-title",attrs:{to:{name:"user-id-tweets",params:{userId:e.user.id}}}},[e._v(" 推文 ")])],1),t("div",{staticClass:"navpill-title-container"},[t("router-link",{staticClass:"navpill-title",attrs:{to:{name:"user-id-replied_tweets",params:{userId:e.user.id}}}},[e._v(" 回覆 ")])],1),t("div",{staticClass:"navpill-title-container"},[t("router-link",{staticClass:"navpill-title",attrs:{to:{name:"user-id-likes",params:{userId:e.user.id}}}},[e._v(" 喜歡的內容 ")])],1)])},n=[],i=s(4648);const a={name:"NavpillUser",props:{initialUser:{type:Object,default:function(){return{id:-1,account:"",email:"",name:"",avatar:"",cover:"",introduction:"",role:"user",followingCount:-1,followerCount:-1}}}},data:function(){return{user:(0,i.Z)({},this.initialUser),isLoading:!0}},watch:{initialUser:function(e){this.user=(0,i.Z)((0,i.Z)({},this.user),e)}}},o=a;var l=s(1001),c=(0,l.Z)(o,r,n,!1,null,null,null);const u=c.exports},23872:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});s(68309);var r=function(){var e=this,t=e._self._c;return t("div",e._l(e.recommendUsers,(function(s){return t("div",{key:s.id,staticClass:"recommendAccount-panel"},[t("div",{staticClass:"recommendAccount-element d-flex align-items-center"},[t("img",{staticClass:"user-headshot",attrs:{src:e._f("emptyImage")(s.avatar),alt:"個人頭像"}}),t("div",[t("router-link",{staticClass:"user-name",attrs:{to:{name:"user-id-tweets",params:{userId:s.id}}}},[e._v(" "+e._s(s.name)+" ")]),t("h4",{staticClass:"user-acount"},[t("span",[e._v("@")]),e._v(e._s(s.account)+" ")])],1),s.isFollowed?t("button",{staticClass:"follow-btn empty-btn-style",attrs:{type:"submit"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.removeFollowing(s.id)}}},[e._v(" 正在跟隨 ")]):t("button",{staticClass:"follow-btn empty-btn-style",attrs:{type:"submit"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addFollowing(s.id)}}},[e._v(" 跟隨 ")])])])})),0)},n=[],i=s(50124),a=s(48534),o=s(4648),l=(s(38862),s(26833),s(76163)),c=s(78390),u=s(63822),d=s(83459);const m={name:"RecommendColumnFollow",mixins:[d.Lf],props:{initialRecommendUsers:{type:Array,required:!0}},data:function(){return{recommendUsers:this.initialRecommendUsers,isProcessing:!1}},computed:(0,o.Z)({},(0,u.rn)(["currentUser"])),watch:{initialRecommendUsers:function(e){this.recommendUsers=(0,o.Z)((0,o.Z)({},this.recommendUsers),e),this.recommendUsers=e}},methods:{addFollowing:function(e){var t=this;return(0,a.Z)((0,i.Z)().mark((function s(){var r,n,a,o,u,d,m;return(0,i.Z)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,c.Z.addFollowing({userId:e});case 4:r=s.sent,n=r.data,console.log("following users=",n),a=JSON.parse(JSON.stringify(t.recommendUsers)),o=Object.values(a),u=0,d=o;case 10:if(!(u<d.length)){s.next=18;break}if(m=d[u],m.id!==e){s.next=15;break}return m.isFollowed=!0,s.abrupt("break",18);case 15:u++,s.next=10;break;case 18:t.recommendUsers=o,t.$emit("fromRCF"),t.isProcessing=!1,s.next=28;break;case 23:s.prev=23,s.t0=s["catch"](0),console.error(s.t0.message),t.isProcessing=!1,l.F.fire({icon:"error",title:"目前無法跟隨使用者，請稍後再試"});case 28:case"end":return s.stop()}}),s,null,[[0,23]])})))()},removeFollowing:function(e){var t=this;return(0,a.Z)((0,i.Z)().mark((function s(){var r,n,a,o,u,d,m;return(0,i.Z)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,c.Z.removeFollowing({userId:e});case 4:r=s.sent,n=r.data,console.log("following users=",n),a=JSON.parse(JSON.stringify(t.recommendUsers)),o=Object.values(a),u=0,d=o;case 10:if(!(u<d.length)){s.next=18;break}if(m=d[u],m.id!==e){s.next=15;break}return m.isFollowed=!1,s.abrupt("break",18);case 15:u++,s.next=10;break;case 18:t.recommendUsers=o,t.$emit("fromRCF"),t.isProcessing=!1,s.next=28;break;case 23:s.prev=23,s.t0=s["catch"](0),console.error(s.t0.message),t.isProcessing=!1,l.F.fire({icon:"error",title:"目前無法取消跟隨使用者，請稍後再試"});case 28:case"end":return s.stop()}}),s,null,[[0,23]])})))()}}},f=m;var v=s(1001),p=(0,v.Z)(f,r,n,!1,null,null,null);const w=p.exports},62488:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex justify-content-center"},[t("NavBar"),t("div",{staticClass:"main-wrapper"},[t("NavpillHeader"),t("UserProfile",{attrs:{"initial-user":e.user}}),t("NavpillUser",{attrs:{"initial-user":e.user}}),t("div",{staticClass:"y-scroll"},[t("router-view",{attrs:{"initial-tweets":e.tweets,"initial-replies":e.replies,"initial-likes":e.likes},on:{fromUserLikeList:e.updatePage}})],1)],1),t("div",{attrs:{id:"recommendColumn-container"}},[e._m(0),t("RecommendColumnFollow",{attrs:{"initial-recommend-users":e.recommendUsers},on:{fromRCF:e.updatePage}})],1)],1)},n=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"recommendHeader mt-4"},[t("h1",[e._v("推薦跟隨")])])}],i=s(50124),a=s(48534),o=s(4648),l=(s(21249),s(5212),s(41539),s(81298)),c=s(23872),u=s(98913),d=(s(68309),function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex-column",attrs:{id:"userProfile-container"}},[t("img",{staticClass:"profile-background-img",attrs:{src:e._f("emptyCover")(e.user.cover),alt:""}}),t("img",{staticClass:"profile-headshot",attrs:{src:e._f("emptyImage")(e.user.avatar),alt:"個人頭像"}}),t("div",{staticClass:"profile-info-container"},[e._m(0),t("h4",{staticClass:"user-name mt-4"},[e._v(" "+e._s(e.user.name)+" ")]),t("p",{staticClass:"user-acount"},[t("span",[e._v("@")]),e._v(" "+e._s(e.user.account)+" ")]),t("p",{staticClass:"user-describe mt-2"},[e._v(" "+e._s(e.user.introduction)+" ")]),t("div",{staticClass:"user-follow-info d-flex mt-2"},[t("router-link",{attrs:{to:{name:"user-id-followinglist",params:{userId:e.user.id}}}},[t("span",{staticClass:"following-number"},[e._v(" "+e._s(e.user.followingCount)+" 個 ")]),t("span",{staticClass:"ml-1"},[e._v("跟隨中")])]),t("router-link",{attrs:{to:{name:"user-id-followerlist",params:{userId:e.user.id}}}},[t("span",{staticClass:"follower-number ml-5"},[e._v(" "+e._s(e.user.followerCount)+" 位 ")]),t("span",{staticClass:"ml-1"},[e._v("跟隨者")])])],1)])])}),m=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex justify-content-end"},[t("button",{staticClass:"edit-profile-btn empty-btn-style ml-4",attrs:{type:"submit"}},[e._v(" 編輯個人資料 ")])])}],f=s(83459);const v={name:"UserProfile",mixins:[f.Lf],props:{initialUser:{type:Object,default:function(){return{id:-1,account:"",email:"",name:"",avatar:"",cover:"",introduction:"",role:"user",followingCount:-1,followerCount:-1}}}},data:function(){return{user:(0,o.Z)({},this.initialUser),isLoading:!0}},watch:{initialUser:function(e){this.user=(0,o.Z)((0,o.Z)({},this.user),e)}}},p=v;var w=s(1001),h=(0,w.Z)(p,d,m,!1,null,null,null);const g=h.exports;var C=s(14951),U=s(63822),_=s(76163),Z=s(78390);const A={name:"UserSelf",components:{NavBar:l.Z,RecommendColumnFollow:c.Z,NavpillHeader:u.Z,UserProfile:g,NavpillUser:C.Z},data:function(){return{user:{id:-1,account:"",email:"",name:"",avatar:"",cover:"",introduction:"",role:"user",followingCount:-1,followerCount:-1},tweets:[],replies:[],likes:[],currentUserLikes:[],recommendUsers:[],isProcessing:!1}},computed:(0,o.Z)({},(0,U.rn)(["currentUser"])),watch:{user:"fetchUserTweetsRepliesLikes"},created:function(){var e=this.currentUser.id;this.fetchFollowingsFollowers(e),this.fetchRecommendUsers()},methods:{updatePage:function(){var e=this.currentUser.id;this.fetchFollowingsFollowers(e),this.fetchRecommendUsers(),this.fetchUserTweetsRepliesLikes()},fetchFollowingsFollowers:function(e){var t=this;return(0,a.Z)((0,i.Z)().mark((function s(){var r,n,a,l;return(0,i.Z)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,Z.Z.getUserFollowings({userId:e});case 3:return r=s.sent,n=r.data,s.next=7,Z.Z.getUserFollowers({userId:e});case 7:a=s.sent,l=a.data,t.user=(0,o.Z)((0,o.Z)({},t.currentUser),{},{followingCount:n.length,followerCount:l.length}),s.next=16;break;case 12:s.prev=12,s.t0=s["catch"](0),console.error(s.t0.message),_.F.fire({icon:"error",title:"無法取得 follow 資料，請稍後再試"});case 16:case"end":return s.stop()}}),s,null,[[0,12]])})))()},fetchUserTweetsRepliesLikes:function(){var e=this;return(0,a.Z)((0,i.Z)().mark((function t(){var s,r,n,a;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log("this.user.id=",e.user.id),t.next=4,Z.Z.getUserLikes({userId:e.currentUser.id});case 4:return s=t.sent,e.currentUserLikes=s.data,t.next=8,Z.Z.getUserTweets({userId:e.user.id});case 8:return r=t.sent,e.tweets=r.data,e.tweets=e.tweets.map((function(t){return e.currentUserLikes.some((function(e){return e.TweetId===t.id}))?(0,o.Z)((0,o.Z)({},t),{},{isLiked:!0}):(0,o.Z)((0,o.Z)({},t),{},{isLiked:!1})})),t.next=13,Z.Z.getUserReplies({userId:e.user.id});case 13:return n=t.sent,e.replies=n.data,t.next=17,Z.Z.getUserLikes({userId:e.user.id});case 17:a=t.sent,e.likes=a.data,t.next=25;break;case 21:t.prev=21,t.t0=t["catch"](0),console.error(t.t0.message),_.F.fire({icon:"error",title:"無法取得 Tweets 資料"});case 25:case"end":return t.stop()}}),t,null,[[0,21]])})))()},fetchRecommendUsers:function(){var e=this;return(0,a.Z)((0,i.Z)().mark((function t(){var s,r,n,a;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,Z.Z.getUserFollowings({userId:e.currentUser.id});case 4:return s=t.sent,r=s.data,n=r,t.next=9,Z.Z.getTopUsers();case 9:a=t.sent,e.recommendUsers=a.data.map((function(e){return(0,o.Z)((0,o.Z)({},e),{},{isFollowed:n.some((function(t){return t.followingId===e.id}))})})),e.isLoading=!1,t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](0),console.error(t.t0),e.isLoading=!1,_.F.fire({icon:"error",title:"無法取得 RecommendUsers 資料，請稍後再試"});case 19:case"end":return t.stop()}}),t,null,[[0,14]])})))()}}},k=A;var x=(0,w.Z)(k,r,n,!1,null,null,null);const b=x.exports},44699:(e,t,s)=>{var r=s(19781),n=s(1702),i=s(81956),a=s(45656),o=s(55296).f,l=n(o),c=n([].push),u=function(e){return function(t){var s,n=a(t),o=i(n),u=o.length,d=0,m=[];while(u>d)s=o[d++],r&&!l(n,s)||c(m,e?[s,n[s]]:n[s]);return m}};e.exports={entries:u(!0),values:u(!1)}},26833:(e,t,s)=>{var r=s(82109),n=s(44699).values;r({target:"Object",stat:!0},{values:function(e){return n(e)}})},57139:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAOCAYAAADJ7fe0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABTSURBVHgBrdLRCQAgCATQo0ncfylHKRTqQwrM88Cojx6UYl6iqlNEvDLBCwBQQyJg5y+kChyEARxhAUc2UC27P9CRlufYQn/s3tAtZqH+sY9QFlmZh9qG/+G4HQAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=488.34845480.js.map