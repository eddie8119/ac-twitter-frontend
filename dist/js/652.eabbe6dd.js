(self["webpackChunkforum_front_end_vue"]=self["webpackChunkforum_front_end_vue"]||[]).push([[652],{98913:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});r(68309);var s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"navpillHeader-container"}},[e._m(0),t("div",{staticClass:"navpill-info-container flex-column"},[t("router-link",{staticClass:"navpillHeader-title",attrs:{to:"/user"}},[e._v(" "+e._s(e.currentUser.name)+" ")]),t("p",{staticClass:"post-number-hint"},[e._v(" "+e._s(e.currentUser.tweetsCount)+" "),t("span",[e._v("推文")])])],1)])},n=[function(){var e=this,t=e._self._c;return t("a",{attrs:{href:"javascript:history.back()"}},[t("img",{staticClass:"arrow-icon",attrs:{src:r(57139),alt:"回到上一頁"}})])}],o=r(4648),a=r(63822);const i={name:"NavpillHeader",data:function(){return{isLoading:!0}},computed:(0,o.Z)({},(0,a.rn)(["currentUser"]))},l=i;var c=r(1001),u=(0,c.Z)(l,s,n,!1,null,null,null);const d=u.exports},93609:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex",attrs:{id:"navpillUser-container"}},[t("div",{staticClass:"navpill-title-container"},[t("router-link",{staticClass:"navpill-title",attrs:{to:{name:"user-id-followerlist",params:{userId:e.user.id}}}},[e._v(" 追隨者 ")])],1),t("div",{staticClass:"navpill-title-container"},[t("router-link",{staticClass:"navpill-title",attrs:{to:{name:"user-id-followinglist",params:{userId:e.user.id}}}},[e._v(" 正在追隨 ")])],1)])},n=[],o=r(4648);const a={name:"NavpillUserFollow",props:{initialUser:{type:Object,default:function(){return{id:-1,account:"",email:"",name:"",avatar:"",cover:"",introduction:"",role:"user",followingCount:-1,followerCount:-1}}}},data:function(){return{user:(0,o.Z)({},this.initialUser),isLoading:!0}},watch:{initialUser:function(e){this.user=(0,o.Z)((0,o.Z)({},this.user),e)}}},i=a;var l=r(1001),c=(0,l.Z)(i,s,n,!1,null,null,null);const u=c.exports},23872:(e,t,r)=>{"use strict";r.d(t,{Z:()=>w});r(68309);var s=function(){var e=this,t=e._self._c;return t("div",e._l(e.recommendUsers,(function(r){return t("div",{key:r.id,staticClass:"recommendAccount-panel"},[t("div",{staticClass:"recommendAccount-element d-flex align-items-center"},[t("img",{staticClass:"user-headshot",attrs:{src:e._f("emptyImage")(r.avatar),alt:"個人頭像"}}),t("div",[t("router-link",{staticClass:"user-name",attrs:{to:{name:"user-id-tweets",params:{userId:r.id}}}},[e._v(" "+e._s(r.name)+" ")]),t("h4",{staticClass:"user-acount"},[t("span",[e._v("@")]),e._v(e._s(r.account)+" ")])],1),r.isFollowed?t("button",{staticClass:"follow-btn empty-btn-style",attrs:{type:"submit"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.removeFollowing(r.id)}}},[e._v(" 正在跟隨 ")]):t("button",{staticClass:"follow-btn empty-btn-style",attrs:{type:"submit"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addFollowing(r.id)}}},[e._v(" 跟隨 ")])])])})),0)},n=[],o=r(50124),a=r(48534),i=r(4648),l=(r(38862),r(26833),r(76163)),c=r(78390),u=r(63822),d=r(83459);const m={name:"RecommendColumnFollow",mixins:[d.Lf],props:{initialRecommendUsers:{type:Array,required:!0}},data:function(){return{recommendUsers:this.initialRecommendUsers,isProcessing:!1}},computed:(0,i.Z)({},(0,u.rn)(["currentUser"])),watch:{initialRecommendUsers:function(e){this.recommendUsers=(0,i.Z)((0,i.Z)({},this.recommendUsers),e),this.recommendUsers=e}},methods:{addFollowing:function(e){var t=this;return(0,a.Z)((0,o.Z)().mark((function r(){var s,n,a,i,u,d,m;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,c.Z.addFollowing({userId:e});case 4:s=r.sent,n=s.data,console.log("following users=",n),a=JSON.parse(JSON.stringify(t.recommendUsers)),i=Object.values(a),u=0,d=i;case 10:if(!(u<d.length)){r.next=18;break}if(m=d[u],m.id!==e){r.next=15;break}return m.isFollowed=!0,r.abrupt("break",18);case 15:u++,r.next=10;break;case 18:t.recommendUsers=i,t.$emit("fromRCF"),t.isProcessing=!1,r.next=28;break;case 23:r.prev=23,r.t0=r["catch"](0),console.error(r.t0.message),t.isProcessing=!1,l.F.fire({icon:"error",title:"目前無法跟隨使用者，請稍後再試"});case 28:case"end":return r.stop()}}),r,null,[[0,23]])})))()},removeFollowing:function(e){var t=this;return(0,a.Z)((0,o.Z)().mark((function r(){var s,n,a,i,u,d,m;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,c.Z.removeFollowing({userId:e});case 4:s=r.sent,n=s.data,console.log("following users=",n),a=JSON.parse(JSON.stringify(t.recommendUsers)),i=Object.values(a),u=0,d=i;case 10:if(!(u<d.length)){r.next=18;break}if(m=d[u],m.id!==e){r.next=15;break}return m.isFollowed=!1,r.abrupt("break",18);case 15:u++,r.next=10;break;case 18:t.recommendUsers=i,t.$emit("fromRCF"),t.isProcessing=!1,r.next=28;break;case 23:r.prev=23,r.t0=r["catch"](0),console.error(r.t0.message),t.isProcessing=!1,l.F.fire({icon:"error",title:"目前無法取消跟隨使用者，請稍後再試"});case 28:case"end":return r.stop()}}),r,null,[[0,23]])})))()}}},f=m;var v=r(1001),p=(0,v.Z)(f,s,n,!1,null,null,null);const w=p.exports},23652:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>U});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-flex justify-content-center"},[t("NavBar"),t("div",{staticClass:"main-wrapper"},[t("NavpillHeader"),t("NavpillUserFollow",{attrs:{"initial-user":e.user}}),t("div",{staticClass:"y-scroll"},[t("router-view",{attrs:{"initial-followers":e.followers,"initial-followings":e.followings},on:{fromFollowingList:e.updatePage,fromFollowerList:e.updatePage}})],1)],1),t("div",{attrs:{id:"recommendColumn-container"}},[e._m(0),t("RecommendColumnFollow",{attrs:{"initial-recommend-users":e.recommendUsers},on:{fromRCF:e.updatePage}})],1)],1)},n=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"recommendHeader mt-4"},[t("h1",[e._v("推薦跟隨")])])}],o=r(50124),a=r(48534),i=r(4648),l=(r(9653),r(21249),r(5212),r(41539),r(68309),r(81298)),c=r(23872),u=r(98913),d=r(93609),m=r(76163),f=r(78390),v=r(63822);const p={name:"UserFollow",components:{NavBar:l.Z,RecommendColumnFollow:c.Z,NavpillHeader:u.Z,NavpillUserFollow:d.Z},beforeRouteUpdate:function(e,t,r){var s=e.params.userId;this.fetchUser(s),this.userId=Number(s),r()},data:function(){return{user:{id:-1,account:"",email:"",name:"",avatar:"",cover:"",introduction:"",role:"user",followingCount:-1,followerCount:-1},userId:-1,followers:[],followings:[],currentUserFollowings:[],recommendUsers:[],isProcessing:!1}},computed:(0,i.Z)({},(0,v.rn)(["currentUser"])),created:function(){var e=this.$route.params.userId;this.fetchUser(e),this.userId=Number(e),this.fetchRecommendUsers()},methods:{updatePage:function(){this.fetchFollowingsFollowers(this.userId),this.fetchRecommendUsers()},fetchFollowingsFollowers:function(e){var t=this;return(0,a.Z)((0,o.Z)().mark((function r(){var s,n,a;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,f.Z.getUserFollowers({userId:e});case 3:return s=r.sent,r.next=6,f.Z.getUserFollowings({userId:e});case 6:return n=r.sent,r.next=9,f.Z.getUserFollowings({userId:t.currentUser.id});case 9:a=r.sent,t.currentUserFollowings=a.data,t.followers=s.data.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{isFollowed:t.currentUserFollowings.some((function(t){return t.followingId===e.followerId}))})})),t.followings=n.data.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{isFollowed:t.currentUserFollowings.some((function(t){return t.followingId===e.followingId}))})})),r.next=19;break;case 15:r.prev=15,r.t0=r["catch"](0),console.error(r.t0.message),m.F.fire({icon:"error",title:"無法 fetch Follow 資料，請稍後再試"});case 19:case"end":return r.stop()}}),r,null,[[0,15]])})))()},fetchUser:function(e){var t=this;return(0,a.Z)((0,o.Z)().mark((function r(){var s,n,a,l,c,u,d,v,p,w,g,h,U,Z;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,f.Z.getUserFollowings({userId:e});case 3:return s=r.sent,n=s.data,r.next=7,f.Z.getUserFollowers({userId:e});case 7:return a=r.sent,l=a.data,console.log("followings=",n),console.log("followers=",l),r.next=13,f.Z.getUser({userId:e});case 13:c=r.sent,u=c.data,d=u.id,v=u.account,p=u.email,w=u.name,g=u.avatar,h=u.cover,U=u.introduction,Z=u.role,t.user=(0,i.Z)((0,i.Z)({},t.user),{},{id:d,account:v,email:p,name:w,avatar:g,cover:h,introduction:U,role:Z,followingCount:n.length,followerCount:l.length}),r.next=23;break;case 19:r.prev=19,r.t0=r["catch"](0),console.error(r.t0.message),m.F.fire({icon:"error",title:"無法取得 User 資料，請稍後再試"});case 23:case"end":return r.stop()}}),r,null,[[0,19]])})))()},fetchRecommendUsers:function(){var e=this;return(0,a.Z)((0,o.Z)().mark((function t(){var r,s,n,a;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,t.next=4,f.Z.getUserFollowings({userId:e.currentUser.id});case 4:return r=t.sent,s=r.data,n=s,t.next=9,f.Z.getTopUsers();case 9:a=t.sent,e.recommendUsers=a.data.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{isFollowed:n.some((function(t){return t.followingId===e.id}))})})),e.isLoading=!1,t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](0),console.error(t.t0),e.isLoading=!1,m.F.fire({icon:"error",title:"無法取得 RecommendUsers 資料，請稍後再試"});case 19:case"end":return t.stop()}}),t,null,[[0,14]])})))()}}},w=p;var g=r(1001),h=(0,g.Z)(w,s,n,!1,null,null,null);const U=h.exports},44699:(e,t,r)=>{var s=r(19781),n=r(1702),o=r(81956),a=r(45656),i=r(55296).f,l=n(i),c=n([].push),u=function(e){return function(t){var r,n=a(t),i=o(n),u=i.length,d=0,m=[];while(u>d)r=i[d++],s&&!l(n,r)||c(m,e?[r,n[r]]:n[r]);return m}};e.exports={entries:u(!0),values:u(!1)}},26833:(e,t,r)=>{var s=r(82109),n=r(44699).values;s({target:"Object",stat:!0},{values:function(e){return n(e)}})},57139:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAOCAYAAADJ7fe0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABTSURBVHgBrdLRCQAgCATQo0ncfylHKRTqQwrM88Cojx6UYl6iqlNEvDLBCwBQQyJg5y+kChyEARxhAUc2UC27P9CRlufYQn/s3tAtZqH+sY9QFlmZh9qG/+G4HQAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=652.eabbe6dd.js.map