(self["webpackChunkforum_front_end_vue"]=self["webpackChunkforum_front_end_vue"]||[]).push([[785],{26012:(e,r,t)=>{"use strict";t.d(r,{Z:()=>d});t(68309);var s=function(){var e=this,r=e._self._c;return r("div",{attrs:{id:"navpillHeader-container"}},[e._m(0),r("div",{staticClass:"navpill-info-container flex-column"},[r("router-link",{staticClass:"navpillHeader-title",attrs:{to:"/user"}},[e._v(" "+e._s(e.currentUser.name)+" ")]),r("p",{staticClass:"post-number-hint"},[e._v(" "+e._s(e.currentUser.tweetsCount)+" "),r("span",[e._v("推文")])])],1)])},n=[function(){var e=this,r=e._self._c;return r("a",{attrs:{href:"javascript:history.back()"}},[r("img",{staticClass:"arrow-icon",attrs:{src:t(57139),alt:"回到上一頁"}})])}],o=t(4648),i=t(63822);const a={name:"NavpillHeader",data:function(){return{isLoading:!0}},computed:(0,o.Z)({},(0,i.rn)(["currentUser"]))},l=a;var c=t(43736),u=(0,c.Z)(l,s,n,!1,null,null,null);const d=u.exports},14118:(e,r,t)=>{"use strict";t.d(r,{Z:()=>u});var s=function(){var e=this,r=e._self._c;return r("div",{staticClass:"d-flex",attrs:{id:"navpillUser-container"}},[r("div",{staticClass:"navpill-title-container"},[r("router-link",{staticClass:"navpill-title",attrs:{to:{name:"user-id-followerlist",params:{userId:e.user.id}}}},[e._v(" 追隨者 ")])],1),r("div",{staticClass:"navpill-title-container"},[r("router-link",{staticClass:"navpill-title",attrs:{to:{name:"user-id-followinglist",params:{userId:e.user.id}}}},[e._v(" 正在追隨 ")])],1)])},n=[],o=t(4648);const i={name:"NavpillUserFollow",props:{initialUser:{type:Object,default:function(){return{id:-1,account:"",email:"",name:"",avatar:"",cover:"",introduction:"",role:"user",followingCount:-1,followerCount:-1}}}},data:function(){return{user:(0,o.Z)({},this.initialUser),isLoading:!0}},watch:{initialUser:function(e){this.user=(0,o.Z)((0,o.Z)({},this.user),e)}}},a=i;var l=t(43736),c=(0,l.Z)(a,s,n,!1,null,null,null);const u=c.exports},48994:(e,r,t)=>{"use strict";t.d(r,{Z:()=>p});t(68309);var s=function(){var e=this,r=e._self._c;return r("div",e._l(e.recommendUsers,(function(t){return r("div",{key:t.id,staticClass:"recommendAccount-panel"},[r("div",{staticClass:"recommendAccount-element d-flex align-items-center"},[r("img",{staticClass:"user-headshot",attrs:{src:e._f("emptyImage")(t.avatar),alt:"個人頭像"}}),r("div",[r("router-link",{staticClass:"user-name",attrs:{to:{name:"user-id-tweets",params:{userId:t.id}}}},[e._v(" "+e._s(t.name)+" ")]),r("h4",{staticClass:"user-acount"},[r("span",[e._v("@")]),e._v(e._s(t.account)+" ")])],1),t.isFollowed?r("button",{staticClass:"follow-btn empty-btn-style",attrs:{type:"submit"},on:{click:function(r){return r.stopPropagation(),r.preventDefault(),e.removeFollowing(t.id)}}},[e._v(" 正在跟隨 ")]):r("button",{staticClass:"follow-btn empty-btn-style",attrs:{type:"submit"},on:{click:function(r){return r.stopPropagation(),r.preventDefault(),e.addFollowing(t.id)}}},[e._v(" 跟隨 ")])])])})),0)},n=[],o=t(50124),i=t(48534),a=t(4648),l=(t(38862),t(26833),t(76163)),c=t(78390),u=t(63822),d=t(83459);const m={name:"RecommendColumnFollow",mixins:[d.Lf],props:{initialRecommendUsers:{type:Array,required:!0}},data:function(){return{recommendUsers:this.initialRecommendUsers,isProcessing:!1}},computed:(0,a.Z)({},(0,u.rn)(["currentUser"])),watch:{initialRecommendUsers:function(e){this.recommendUsers=(0,a.Z)((0,a.Z)({},this.recommendUsers),e),this.recommendUsers=e}},methods:{addFollowing:function(e){var r=this;return(0,i.Z)((0,o.Z)().mark((function t(){var s,n,i,a,u,d,m;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r.isProcessing=!0,t.next=4,c.Z.addFollowing({userId:e});case 4:s=t.sent,n=s.data,console.log("following users=",n),i=JSON.parse(JSON.stringify(r.recommendUsers)),a=Object.values(i),u=0,d=a;case 10:if(!(u<d.length)){t.next=18;break}if(m=d[u],m.id!==e){t.next=15;break}return m.isFollowed=!0,t.abrupt("break",18);case 15:u++,t.next=10;break;case 18:r.recommendUsers=a,r.$emit("fromRCF"),r.isProcessing=!1,t.next=28;break;case 23:t.prev=23,t.t0=t["catch"](0),console.error(t.t0.message),r.isProcessing=!1,l.F.fire({icon:"error",title:"目前無法跟隨使用者，請稍後再試"});case 28:case"end":return t.stop()}}),t,null,[[0,23]])})))()},removeFollowing:function(e){var r=this;return(0,i.Z)((0,o.Z)().mark((function t(){var s,n,i,a,u,d,m;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r.isProcessing=!0,t.next=4,c.Z.removeFollowing({userId:e});case 4:s=t.sent,n=s.data,console.log("following users=",n),i=JSON.parse(JSON.stringify(r.recommendUsers)),a=Object.values(i),u=0,d=a;case 10:if(!(u<d.length)){t.next=18;break}if(m=d[u],m.id!==e){t.next=15;break}return m.isFollowed=!1,t.abrupt("break",18);case 15:u++,t.next=10;break;case 18:r.recommendUsers=a,r.$emit("fromRCF"),r.isProcessing=!1,t.next=28;break;case 23:t.prev=23,t.t0=t["catch"](0),console.error(t.t0.message),r.isProcessing=!1,l.F.fire({icon:"error",title:"目前無法取消跟隨使用者，請稍後再試"});case 28:case"end":return t.stop()}}),t,null,[[0,23]])})))()}}},f=m;var v=t(43736),w=(0,v.Z)(f,s,n,!1,null,null,null);const p=w.exports},91785:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>U});var s=function(){var e=this,r=e._self._c;return r("div",{staticClass:"d-flex justify-content-center"},[r("NavBar"),r("div",{staticClass:"main-wrapper"},[r("NavpillHeader"),r("NavpillUserFollow",{attrs:{"initial-user":e.user}}),r("div",{staticClass:"y-scroll"},[r("router-view",{attrs:{"initial-followers":e.followers,"initial-followings":e.followings},on:{fromFollowingList:e.updatePage,fromFollowerList:e.updatePage}})],1)],1),r("div",{attrs:{id:"recommendColumn-container"}},[e._m(0),r("RecommendColumnFollow",{attrs:{"initial-recommend-users":e.recommendUsers},on:{fromRCF:e.updatePage}})],1)],1)},n=[function(){var e=this,r=e._self._c;return r("div",{staticClass:"recommendHeader mt-4"},[r("h1",[e._v("推薦跟隨")])])}],o=t(50124),i=t(48534),a=t(4648),l=(t(9653),t(21249),t(5212),t(41539),t(68309),t(38359)),c=t(48994),u=t(26012),d=t(14118),m=t(76163),f=t(78390),v=t(63822);const w={name:"UserOtherFollow",components:{NavBar:l.Z,RecommendColumnFollow:c.Z,NavpillHeader:u.Z,NavpillUserFollow:d.Z},beforeRouteUpdate:function(e,r,t){var s=e.params.userId;this.fetchUser(s),this.userId=Number(s),t()},data:function(){return{user:{id:-1,account:"",email:"",name:"",avatar:"",cover:"",introduction:"",role:"user",followingCount:-1,followerCount:-1},userId:-1,followers:[],followings:[],currentUserFollowings:[],recommendUsers:[],isProcessing:!1}},computed:(0,a.Z)({},(0,v.rn)(["currentUser"])),created:function(){var e=this.$route.params.userId;this.fetchUser(e),this.userId=Number(e),this.fetchRecommendUsers()},methods:{updatePage:function(){this.fetchFollowingsFollowers(this.userId),this.fetchRecommendUsers()},fetchFollowingsFollowers:function(e){var r=this;return(0,i.Z)((0,o.Z)().mark((function t(){var s,n,i;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.Z.getUserFollowers({userId:e});case 3:return s=t.sent,t.next=6,f.Z.getUserFollowings({userId:e});case 6:return n=t.sent,t.next=9,f.Z.getUserFollowings({userId:r.currentUser.id});case 9:i=t.sent,r.currentUserFollowings=i.data,r.followers=s.data.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{isFollowed:r.currentUserFollowings.some((function(r){return r.followingId===e.followerId}))})})),r.followings=n.data.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{isFollowed:r.currentUserFollowings.some((function(r){return r.followingId===e.followingId}))})})),t.next=19;break;case 15:t.prev=15,t.t0=t["catch"](0),console.error(t.t0.message),m.F.fire({icon:"error",title:"無法 fetch Follow 資料，請稍後再試"});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))()},fetchUser:function(e){var r=this;return(0,i.Z)((0,o.Z)().mark((function t(){var s,n,i,l,c,u,d,v,w,p,g,h,U;return(0,o.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.Z.getUserFollowings({userId:e});case 3:return s=t.sent,t.next=6,f.Z.getUserFollowers({userId:e});case 6:return n=t.sent,t.next=9,f.Z.getUserFollowings({userId:r.currentUser.id});case 9:return i=t.sent,r.currentUserFollowings=i.data,r.followings=s.data.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{isFollowed:r.currentUserFollowings.some((function(r){return r.followingId===e.followingId}))})})),r.followers=n.data.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{isFollowed:r.currentUserFollowings.some((function(r){return r.followingId===e.followerId}))})})),t.next=15,f.Z.getUser({userId:e});case 15:l=t.sent,c=l.data,u=c.id,d=c.account,v=c.email,w=c.name,p=c.avatar,g=c.cover,h=c.introduction,U=c.role,r.user=(0,a.Z)((0,a.Z)({},r.user),{},{id:u,account:d,email:v,name:w,avatar:p,cover:g,introduction:h,role:U,followingCount:r.followings.length,followerCount:r.followers.length}),t.next=25;break;case 21:t.prev=21,t.t0=t["catch"](0),console.error(t.t0.message),m.F.fire({icon:"error",title:"無法取得 User 資料，請稍後再試"});case 25:case"end":return t.stop()}}),t,null,[[0,21]])})))()},fetchRecommendUsers:function(){var e=this;return(0,i.Z)((0,o.Z)().mark((function r(){var t,s,n,i;return(0,o.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.isLoading=!0,r.next=4,f.Z.getUserFollowings({userId:e.currentUser.id});case 4:return t=r.sent,s=t.data,n=s,r.next=9,f.Z.getTopUsers();case 9:i=r.sent,e.recommendUsers=i.data.map((function(e){return(0,a.Z)((0,a.Z)({},e),{},{isFollowed:n.some((function(r){return r.followingId===e.id}))})})),e.isLoading=!1,r.next=19;break;case 14:r.prev=14,r.t0=r["catch"](0),console.error(r.t0),e.isLoading=!1,m.F.fire({icon:"error",title:"無法取得 RecommendUsers 資料，請稍後再試"});case 19:case"end":return r.stop()}}),r,null,[[0,14]])})))()}}},p=w;var g=t(43736),h=(0,g.Z)(p,s,n,!1,null,null,null);const U=h.exports},44699:(e,r,t)=>{var s=t(19781),n=t(1702),o=t(81956),i=t(45656),a=t(55296).f,l=n(a),c=n([].push),u=function(e){return function(r){var t,n=i(r),a=o(n),u=a.length,d=0,m=[];while(u>d)t=a[d++],s&&!l(n,t)||c(m,e?[t,n[t]]:n[t]);return m}};e.exports={entries:u(!0),values:u(!1)}},26833:(e,r,t)=>{var s=t(82109),n=t(44699).values;s({target:"Object",stat:!0},{values:function(e){return n(e)}})},57139:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAOCAYAAADJ7fe0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABTSURBVHgBrdLRCQAgCATQo0ncfylHKRTqQwrM88Cojx6UYl6iqlNEvDLBCwBQQyJg5y+kChyEARxhAUc2UC27P9CRlufYQn/s3tAtZqH+sY9QFlmZh9qG/+G4HQAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=785.7255e069.js.map